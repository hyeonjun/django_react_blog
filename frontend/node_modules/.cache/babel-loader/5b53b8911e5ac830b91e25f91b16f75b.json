{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"C:/django-react/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link,Route,BrowserRouter as Router,Switch}from\"react-router-dom\";import HomePage from\"./views/HomePage\";import LoginPage from\"./views/LoginPage\";import RegisterPage from\"./views/RegisterPage\";import'./index.css';import Sidebarmenu from\"./Sidebar/Sidebarmenu\";import Header from\"./views/Header\";import Profile from\"./Sidebar/Profile\";import Tier from\"./Sidebar/Tier\";import Point from\"./Sidebar/Point\";import Pointcg from\"./Sidebar/Pointcg\";// import { colors } from '@material-ui/core';\nfunction App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modal=_useState2[0],setModal=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(localStorage.getItem('token')?true:false),_useState6=_slicedToArray(_useState5,2),isAuthenticated=_useState6[0],setisAuthenticated=_useState6[1];var userHasAuthenticated=function userHasAuthenticated(authenticated,username,token){setisAuthenticated(authenticated);setUser(username);localStorage.setItem('token',token);// console.log(localStorage.getItem(token));\n// window.location.reload();\n};//회원가입이나 로그인이 성공했을 때 토큰을 저장\n// if(flag === 1){\n//   // window.location.reload();\n//   setFlag(0);\n//   console.log(flag);\n// } else{\nvar handleLogout=function handleLogout(){setisAuthenticated(false);setUser(\"\");localStorage.removeItem('token');// setModal(false)\n};//로그아웃\nuseEffect(function(){if(isAuthenticated){setModal(true);}else{setModal(false);}},[isAuthenticated]);useEffect(function(){if(isAuthenticated){//Token 값이 타당간가 /validate 요청을 통해 확인하고\n// 상태 코드가 200이라면 /api/current 요청으로 user정보 받아옴\nconsole.log(\"\".concat(localStorage.getItem('token')));fetch('http://39.118.174.168:8000/api/validate/',{method:'POST',headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){fetch('http://39.118.174.168:8000/api/current_user/',{method:'GET',headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){return res.json();}).then(function(json){if(json.username){setUser(json.username);}else{//유저가 등록되지 않았다면 로그인 버튼이 나오도록\nsetModal(false);setisAuthenticated(false);}// Refresh Token을 발급 -> 만료 시간 연장\nfetch('http://39.118.174.168:8000/api/refresh/',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:localStorage.getItem('token')})}).then(function(res){return res.json();}).then(function(json){userHasAuthenticated(true,json.user.username,json.token);}).catch(function(error){console.log(error);});}).catch(function(error){handleLogout();console.log(error);});}).catch(function(error){handleLogout();console.log(error);});}},[isAuthenticated]);return/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Title\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Leftside\",children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"a\",{className:\"T_title\",href:\"/\",children:\"LoLtopia\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"Rightside\",children:/*#__PURE__*/_jsx(\"div\",{className:\"Another\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Navbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"LeftSide\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"Links\",children:[/*#__PURE__*/_jsx(Link,{to:\"Primium\",children:\"\\uD504\\uB9AC\\uBBF8\\uC5C4 \\uD30C\\uD2B8\\uB108\"}),/*#__PURE__*/_jsx(Link,{to:\"Teacher\",children:\"\\uC77C\\uBC18 \\uD30C\\uD2B8\\uB108\"}),/*#__PURE__*/_jsx(Link,{to:\"Free\",children:\"\\uC790\\uC720 \\uC218\\uAC15\\uC0DD\"}),/*#__PURE__*/_jsx(Link,{to:\"Oneplay\",children:\"\\uC77C\\uBC18 \\uC218\\uAC15\\uC0DD\"})]})})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/\",children:[/*#__PURE__*/_jsx(Header,{modal:modal,handleLogout:handleLogout}),/*#__PURE__*/_jsx(HomePage,{modal:modal,user:user,userHasAuthenticated:userHasAuthenticated})]}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/login\",children:/*#__PURE__*/_jsx(LoginPage,{setModal:setModal,userHasAuthenticated:userHasAuthenticated})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/register\",children:/*#__PURE__*/_jsx(RegisterPage,{setModal:setModal,userHasAuthenticated:userHasAuthenticated})}),/*#__PURE__*/_jsx(Route,{path:\"/Sidebarmenu\",exact:true,component:Sidebarmenu}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/profile\",children:[/*#__PURE__*/_jsx(Header,{modal:modal,handleLogout:handleLogout}),/*#__PURE__*/_jsx(Profile,{handleLogout:handleLogout})]}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/tier\",children:[/*#__PURE__*/_jsx(Header,{modal:modal,handleLogout:handleLogout}),/*#__PURE__*/_jsx(Tier,{})]}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/point\",children:[/*#__PURE__*/_jsx(Header,{modal:modal,handleLogout:handleLogout}),/*#__PURE__*/_jsx(Point,{})]}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/pointcg\",children:[/*#__PURE__*/_jsx(Header,{modal:modal,handleLogout:handleLogout}),/*#__PURE__*/_jsx(Pointcg,{})]})]})})]});}export default App;","map":{"version":3,"sources":["C:/django-react/frontend/src/App.js"],"names":["React","useState","useEffect","Link","Route","BrowserRouter","Router","Switch","HomePage","LoginPage","RegisterPage","Sidebarmenu","Header","Profile","Tier","Point","Pointcg","App","modal","setModal","user","setUser","localStorage","getItem","isAuthenticated","setisAuthenticated","userHasAuthenticated","authenticated","username","token","setItem","handleLogout","removeItem","console","log","fetch","method","headers","Authorization","then","res","json","body","JSON","stringify","catch","error"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { Link, Route, BrowserRouter as Router, Switch } from \"react-router-dom\";\nimport HomePage from \"./views/HomePage\";\nimport LoginPage from \"./views/LoginPage\";\nimport RegisterPage from \"./views/RegisterPage\";\nimport './index.css';\nimport Sidebarmenu from \"./Sidebar/Sidebarmenu\";\nimport Header from \"./views/Header\";\nimport Profile from \"./Sidebar/Profile\";\nimport Tier from \"./Sidebar/Tier\";\nimport Point from \"./Sidebar/Point\";\nimport Pointcg from \"./Sidebar/Pointcg\";\n// import { colors } from '@material-ui/core';\n\nfunction App(){\n\n  const [modal, setModal] = useState(false);\n  const [user, setUser] = useState([])\n  let [isAuthenticated, setisAuthenticated] = useState(localStorage.getItem('token') ? true : false)\n\n  const userHasAuthenticated = (authenticated, username, token) => { \n    setisAuthenticated(authenticated);\n    setUser(username);\n    localStorage.setItem('token', token);\n    // console.log(localStorage.getItem(token));\n    // window.location.reload();\n  } //회원가입이나 로그인이 성공했을 때 토큰을 저장\n\n  // if(flag === 1){\n  //   // window.location.reload();\n  //   setFlag(0);\n  //   console.log(flag);\n  // } else{\n\n  const handleLogout = () => {\n    setisAuthenticated(false);\n    setUser(\"\");\n    localStorage.removeItem('token');\n    // setModal(false)\n  }//로그아웃\n\n  useEffect(()=>{\n    if(isAuthenticated){\n      setModal(true);\n    }\n    else{\n      setModal(false);\n    }\n  },[isAuthenticated])\n\n  useEffect(() => {\n    if(isAuthenticated) {\n      //Token 값이 타당간가 /validate 요청을 통해 확인하고\n      // 상태 코드가 200이라면 /api/current 요청으로 user정보 받아옴\n      console.log(`${localStorage.getItem('token')}`);\n      fetch('http://39.118.174.168:8000/api/validate/', {\n        method: 'POST',\n        headers: {\n          Authorization: `JWT ${localStorage.getItem('token')}`\n        }\n      })\n      .then(res => {\n        fetch('http://39.118.174.168:8000/api/current_user/', {\n          method: 'GET',\n          headers: {\n            Authorization: `JWT ${localStorage.getItem('token')}`\n          }\n        })\n        .then(res => res.json())\n        .then(json => {\n          if(json.username) {\n            setUser(json.username);\n          }\n          else{\n            //유저가 등록되지 않았다면 로그인 버튼이 나오도록\n            setModal(false)\n            setisAuthenticated(false)\n        }\n        // Refresh Token을 발급 -> 만료 시간 연장\n        fetch('http://39.118.174.168:8000/api/refresh/', {\n          method : 'POST',\n          headers: {\n            'Content-Type' : 'application/json'\n          },\n          body: JSON.stringify({\n            token: localStorage.getItem('token')\n          })\n        })\n        .then(res => res.json())\n        .then((json)=>{\n          userHasAuthenticated(true, json.user.username, json.token);\n        })\n        .catch(error => {\n          console.log(error);\n        });\n      })\n      .catch(error => {\n        handleLogout();\n        console.log(error);\n      });\n    })\n    .catch(error => {\n      handleLogout();\n      console.log(error);\n    })\n  }\n}, [isAuthenticated])\n\n\n  return (\n    <Router>\n      <header>\n            \n            <div className=\"Title\">\n                <div className=\"Leftside\">\n                    \n                    <Link to=\"/\">\n                    <a className=\"T_title\" href=\"/\">LoLtopia</a>\n                    </Link>\n                </div>\n          \n                <div className=\"Rightside\">\n                    <div className=\"Another\">\n                        {/* <Header modal={modal} handleLogout={handleLogout}/> */}\n                    </div>   \n                    \n                </div>\n            \n            </div>\n            <div className=\"Navbar\">\n                <div className=\"LeftSide\">\n                    <div className=\"Links\">\n                        \n                        <Link to=\"Primium\">\n                        프리미엄 파트너\n                        </Link>\n                        \n                        <Link to=\"Teacher\">\n                        일반 파트너\n                        </Link>\n\n                        <Link to=\"Free\">\n                        자유 수강생\n                        </Link>\n\n                        <Link to=\"Oneplay\">\n                        일반 수강생\n                        </Link>\n                        \n                    </div>\n                </div>\n            </div>\n    \n      </header>\n      <div>\n        <Switch>\n          <Route exact path=\"/\">\n             <Header modal={modal} handleLogout={handleLogout}/>\n            <HomePage modal={modal} user={user} userHasAuthenticated={userHasAuthenticated} />\n          </Route>\n          <Route exact path=\"/login\">\n            <LoginPage \n            setModal={setModal} userHasAuthenticated={userHasAuthenticated}/>\n          </Route>\n          <Route exact path=\"/register\">\n            <RegisterPage setModal={setModal} userHasAuthenticated={userHasAuthenticated}/>\n          </Route> \n\n          <Route path=\"/Sidebarmenu\" exact component={Sidebarmenu}>\n       \n          </Route>\n         \n          <Route exact path=\"/profile\">\n          <Header modal={modal} handleLogout={handleLogout}/>\n            <Profile handleLogout={handleLogout}/>\n            </Route>  \n          <Route exact path=\"/tier\">\n          <Header modal={modal} handleLogout={handleLogout}/>\n            <Tier />\n          </Route>\n\n          <Route exact path=\"/point\">\n          <Header modal={modal} handleLogout={handleLogout}/>\n          <Point />\n          </Route>\n\n          <Route exact path=\"/pointcg\">\n          <Header modal={modal} handleLogout={handleLogout}/>\n          <Pointcg />\n          </Route>\n\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}