{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\django-react\\\\frontend\\\\src\\\\views\\\\Detail.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport '../views/Detail.css';\nimport { Link } from 'react-router-dom';\nimport { useHistory } from 'react-router';\n\nfunction Detail(props) {\n  _s();\n\n  const history = useHistory(); // let Today = new Date();\n  // let date = Today.getFullYear() + \"-\" + Today.getMonth() + \"-\" + Today.getDate()\n\n  let pgN = document.location.href.split('/')[4];\n  let [detailList, setDetailList] = useState({});\n  let [detailUserInfo, setDetailUserInfo] = useState({});\n  let [detailDate, setDetailDate] = useState();\n  let [detailLang, setDetailLang] = useState([]);\n  let [detailLikedUser, setDetailLikedUser] = useState([]);\n  let [svgColor, setSvgColor] = useState({});\n  let [currnetUser, setCurrentUser] = useState({});\n  useEffect(() => {\n    fetch('http://39.118.174.168:8000/board/' + props.path + pgN + \"/\").then(res => res.json()).then(posts => {\n      // console.log(posts)\n      setDetailList(posts);\n      let Y = posts.pub_date.split('-')[0];\n      let M = posts.pub_date.split('-')[1];\n      let D = posts.pub_date.split('-')[2].split('T')[0];\n      setDetailDate(Y + \"년 \" + M + \"월 \" + D + \"일\");\n      setDetailLang(posts.infomation.split(','));\n      setDetailLikedUser(posts.likedUser.split(','));\n      fetch('http://39.118.174.168:8000/api/current_user/', {\n        headers: {\n          Authorization: `JWT ${localStorage.getItem('token')}`\n        }\n      }).then(res => res.json()).then(json => {\n        fetch('http://39.118.174.168:8000/api/profile/' + json.id + '/update/', {\n          method: 'PATCH',\n          headers: {\n            Authorization: `JWT ${localStorage.getItem('token')}`\n          }\n        }).then(res => res.json()).then(userData => {\n          setCurrentUser(userData);\n        });\n      });\n      fetch('http://39.118.174.168:8000/api/profile/' + posts.user_id + '/').then(res => res.json()).then(info => {\n        setDetailUserInfo(info);\n      });\n    });\n  }, [pgN, props.path]);\n\n  const DelBoard = () => {\n    if (currnetUser.user_id === detailList.user_id) {\n      if (window.confirm('정말 삭제하시겠습니까 ?') === true) {\n        fetch('http://39.118.174.168:8000/board/' + props.path + pgN + \"/delete/\", {\n          method: 'DELETE',\n          headers: {\n            Authorization: `JWT ${localStorage.getItem('token')}`\n          }\n        }).then(res => res.json()).catch(error => console.error('Error:', error)).then(response => console.log('Success:', JSON.stringify(response)));\n        window.location.href = '/';\n      }\n    } else {\n      alert(\"권한이 없습니다.\");\n    }\n  };\n\n  const UpdateBoard = () => {\n    detailList.user_id === currnetUser.user_id ? history.push(\"/update/\" + pgN) : alert(\"권한이 없습니다.\");\n  };\n\n  let sendData;\n\n  const handleEffect = ClickLikeBtn => {\n    if (currnetUser.user_id !== null && currnetUser.user_id !== undefined && currnetUser.user_id !== \"\") {\n      // detailLikedUser라는 state값이 currentUser.user_pk(접속해있는 유저의 pk값)을 index로 가지고있지 않다면\n      if (detailLikedUser.indexOf(currnetUser.user_id + \"\") === -1) {\n        //추천\n        let arr = [...detailLikedUser];\n        arr.push(currnetUser.user_id);\n        let plusUser = arr.join(',');\n        sendData = {\n          like: detailList.like + 1,\n          likedUser: plusUser\n        };\n        setSvgColor({\n          color: \"black\"\n        });\n      } else {\n        //추천취소\n        let arr = [...detailLikedUser];\n        arr.splice(arr.indexOf(currnetUser.user_id + \"\"), 1);\n        let minusUser = arr.join(',');\n        sendData = {\n          like: detailList.like - 1,\n          likedUser: minusUser\n        };\n        setSvgColor({\n          color: \"gray\"\n        });\n      }\n\n      ClickLikeBtn();\n    } else {\n      alert(\"로그인이 필요합니다.\");\n      window.location.href = \"/login\";\n    }\n  };\n\n  const ClickLikeBtn = () => {\n    let form_data = new FormData();\n    form_data.append('like', sendData.like);\n    form_data.append('likedUser', sendData.likedUser);\n    fetch('http://39.118.174.168:8000/board/' + props.path + pgN + \"/update/\", {\n      method: 'PATCH',\n      headers: {\n        Authorization: `JWT ${localStorage.getItem('token')}`\n      },\n      body: form_data\n    }).then(res => res.json()).catch(error => console.error('Error:', error)).then(() => {\n      fetch('http://39.118.174.168:8000/board/' + props.path + pgN + \"/\").then(res => res.json()).then(posts => {\n        setDetailList(posts);\n        console.log(posts);\n        setDetailLikedUser(posts.likedUser.split(','));\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detail__container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail__head-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: detailList.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__head-btn\",\n          children: detailList.user_id === currnetUser.user_id ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: UpdateBoard,\n              children: \"\\uC218\\uC815\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: DelBoard,\n              children: \"\\uC0AD\\uC81C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__head-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"information\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"detail__head-username\",\n              children: detailList.nickname\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 29\n            }, this), console.log(detailList.nickname), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"separator\",\n              children: \"\\xB7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [detailDate, detailList.updateCount === 0 ? null : \"  ·  수정됨\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail__head-mobileLike\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"likeBtn\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"24\",\n                height: \"24\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  fill: \"currentColor\",\n                  d: \"M18 1l-6 4-6-4-6 5v7l12 10 12-10v-7z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 81\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: detailList.like\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__head-like\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"iCfLcp\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dtrfkW\",\n              onClick: () => {\n                handleEffect(ClickLikeBtn);\n              },\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                style: svgColor,\n                width: \"24\",\n                height: \"24\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  fill: \"currentColor\",\n                  d: \"M18 1l-6 4-6-4-6 5v7l12 10 12-10v-7z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 98\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sc-iyvyFf bJqQCy\",\n              children: detailList.like\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filetrList\",\n          children: detailLang.map((a, i) => {\n            return /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"#\", a]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 33\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this), detailList.image === null ? null : /*#__PURE__*/_jsxDEV(\"img\", {\n          src: detailList.image,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 27\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail__body-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__content\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            dangerouslySetInnerHTML: {\n              __html: detailList.contents\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail__footer-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__writerInfo\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail__topInfo\",\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              to: \"/mysite/\" + detailList.id,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: detailList.profileImage,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail__userInfo\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"description\",\n                children: detailUserInfo.myInfo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sc-epnACN eIoWCE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail__buttomInfo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail__comment-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail__comment-width\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"margin__top\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s(Detail, \"yB2H0y288UmECVFZ6iKPz/i8hkk=\", false, function () {\n  return [useHistory];\n});\n\n_c = Detail;\nexport default Detail;\n\nvar _c;\n\n$RefreshReg$(_c, \"Detail\");","map":{"version":3,"sources":["C:/django-react/frontend/src/views/Detail.js"],"names":["React","useState","useEffect","Link","useHistory","Detail","props","history","pgN","document","location","href","split","detailList","setDetailList","detailUserInfo","setDetailUserInfo","detailDate","setDetailDate","detailLang","setDetailLang","detailLikedUser","setDetailLikedUser","svgColor","setSvgColor","currnetUser","setCurrentUser","fetch","path","then","res","json","posts","Y","pub_date","M","D","infomation","likedUser","headers","Authorization","localStorage","getItem","id","method","userData","user_id","info","DelBoard","window","confirm","catch","error","console","response","log","JSON","stringify","alert","UpdateBoard","push","sendData","handleEffect","ClickLikeBtn","undefined","indexOf","arr","plusUser","join","like","color","splice","minusUser","form_data","FormData","append","body","title","nickname","updateCount","map","a","i","image","__html","contents","profileImage","myInfo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport '../views/Detail.css';\r\nimport {Link} from 'react-router-dom';\r\nimport { useHistory } from 'react-router'\r\n\r\nfunction Detail(props){\r\n    const history = useHistory()\r\n    // let Today = new Date();\r\n    // let date = Today.getFullYear() + \"-\" + Today.getMonth() + \"-\" + Today.getDate()\r\n\r\n    let pgN = document.location.href.split('/')[4]\r\n\r\n    let [detailList, setDetailList] = useState({});\r\n    let [detailUserInfo, setDetailUserInfo] = useState({});\r\n    let [detailDate, setDetailDate] = useState();\r\n    let [detailLang, setDetailLang] = useState([]);\r\n\r\n    let [detailLikedUser, setDetailLikedUser] = useState([]);\r\n    let [svgColor, setSvgColor] = useState({});\r\n\r\n    let [currnetUser, setCurrentUser] = useState({});\r\n    \r\n    useEffect(()=>{\r\n        fetch('http://39.118.174.168:8000/board/'+ props.path + pgN + \"/\")\r\n        .then((res)=>res.json())\r\n            .then((posts)=>{\r\n                // console.log(posts)\r\n                setDetailList(posts)\r\n                let Y = posts.pub_date.split('-')[0]\r\n                let M = posts.pub_date.split('-')[1]\r\n                let D = posts.pub_date.split('-')[2].split('T')[0]\r\n                setDetailDate(Y + \"년 \" + M + \"월 \" + D + \"일\")\r\n                setDetailLang(posts.infomation.split(','))\r\n                setDetailLikedUser(posts.likedUser.split(','))\r\n                fetch('http://39.118.174.168:8000/api/current_user/', {\r\n                headers: {\r\n                    Authorization: `JWT ${localStorage.getItem('token')}`\r\n                }\r\n                })\r\n                .then(res => res.json())\r\n                .then(json => {\r\n                fetch('http://39.118.174.168:8000/api/profile/' + json.id + '/update/',{\r\n                        method : 'PATCH',\r\n                        headers: {\r\n                            Authorization: `JWT ${localStorage.getItem('token')}`\r\n                        },\r\n                    })\r\n                    .then((res)=>res.json())\r\n                    .then((userData)=> {\r\n                        setCurrentUser(userData)\r\n                    })\r\n                })  \r\n                fetch('http://39.118.174.168:8000/api/profile/' + posts.user_id + '/')\r\n                .then((res)=>res.json())\r\n                .then((info)=>{\r\n                    setDetailUserInfo(info)\r\n                })\r\n            })\r\n    },[pgN,props.path])\r\n\r\n    const DelBoard = ()=>{\r\n        if(currnetUser.user_id === detailList.user_id){\r\n            if(window.confirm('정말 삭제하시겠습니까 ?')===true){\r\n                fetch('http://39.118.174.168:8000/board/'+ props.path + pgN + \"/delete/\", {\r\n                method : 'DELETE',\r\n                headers: {\r\n                    Authorization : `JWT ${localStorage.getItem('token')}`,\r\n                }\r\n                })\r\n                .then(res => res.json())\r\n                .catch(error => console.error('Error:', error))\r\n                .then(response => console.log('Success:', JSON.stringify(response)));\r\n                window.location.href = '/';\r\n            }\r\n        }else{\r\n            alert(\"권한이 없습니다.\")\r\n        }\r\n    }\r\n\r\n    const UpdateBoard = () => {\r\n        detailList.user_id === currnetUser.user_id\r\n        ? history.push(\"/update/\"+pgN)\r\n        : alert(\"권한이 없습니다.\")\r\n    }\r\n\r\n\r\n    let sendData;\r\n    const handleEffect = (ClickLikeBtn) => {\r\n        if(currnetUser.user_id !== null && currnetUser.user_id !== undefined && currnetUser.user_id !== \"\"){\r\n        // detailLikedUser라는 state값이 currentUser.user_pk(접속해있는 유저의 pk값)을 index로 가지고있지 않다면\r\n            if(detailLikedUser.indexOf(currnetUser.user_id + \"\") === -1){ //추천\r\n                let arr = [...detailLikedUser]\r\n                arr.push(currnetUser.user_id)\r\n                let plusUser = arr.join(',')\r\n                sendData = {\r\n                    like : detailList.like + 1,\r\n                    likedUser : plusUser\r\n                }\r\n                setSvgColor({color : \"black\"})\r\n            }else{ //추천취소\r\n                let arr = [...detailLikedUser]\r\n                arr.splice(arr.indexOf(currnetUser.user_id + \"\"), 1)\r\n                let minusUser = arr.join(',')\r\n                 sendData = {\r\n                    like : detailList.like - 1,\r\n                    likedUser : minusUser\r\n                }\r\n                setSvgColor({color : \"gray\"}) \r\n            }\r\n            ClickLikeBtn()\r\n        }else {\r\n            alert(\"로그인이 필요합니다.\")\r\n            window.location.href =\"/login\"\r\n        }\r\n        \r\n    }\r\n\r\n    const ClickLikeBtn = ()=>{\r\n        let form_data = new FormData();\r\n        form_data.append('like', sendData.like);\r\n        form_data.append('likedUser', sendData.likedUser);\r\n\r\n        fetch('http://39.118.174.168:8000/board/'+ props.path + pgN + \"/update/\", {\r\n            method : 'PATCH',\r\n            headers: {\r\n                Authorization : `JWT ${localStorage.getItem('token')}`,\r\n            },\r\n            body : form_data\r\n        })\r\n        .then(res => res.json())\r\n        .catch(error => console.error('Error:', error))\r\n        .then(()=>{\r\n            fetch('http://39.118.174.168:8000/board/'+ props.path + pgN + \"/\")\r\n            .then((res)=>res.json())\r\n            .then((posts)=>{\r\n                setDetailList(posts)\r\n                console.log(posts)\r\n                setDetailLikedUser(posts.likedUser.split(','))\r\n            });\r\n        })\r\n    }    \r\n\r\n    return(\r\n        <>\r\n            <div className=\"detail__container\">\r\n                <div className=\"detail__head-wrapper\">\r\n                    <h1>{detailList.title}</h1>\r\n                    <div className=\"detail__head-btn\">\r\n                        {\r\n                            detailList.user_id === currnetUser.user_id\r\n                            ?(\r\n                                <>\r\n                                <button onClick={UpdateBoard}>수정</button>\r\n                                <button onClick={DelBoard}>삭제</button>\r\n                                </>\r\n                            )\r\n                            : null\r\n                        }\r\n                    </div>\r\n                    <div className=\"detail__head-info\">\r\n                        <div className=\"information\">\r\n                            <span className=\"detail__head-username\">{detailList.nickname}</span>\r\n                            {\r\n                            console.log(detailList.nickname)\r\n                            }\r\n                            <span className=\"separator\">·</span>\r\n                            <span>{detailDate}{detailList.updateCount === 0 ? null : \"  ·  수정됨\"}</span>\r\n                        </div>\r\n                        <div className=\"detail__head-mobileLike\">\r\n                            <button className=\"likeBtn\">\r\n                                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M18 1l-6 4-6-4-6 5v7l12 10 12-10v-7z\"></path></svg>\r\n                                <span>{detailList.like}</span>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"detail__head-like\">\r\n                        <div className=\"iCfLcp\">\r\n                            <div className=\"dtrfkW\" onClick={()=>{handleEffect(ClickLikeBtn)}}>\r\n                                <svg style={svgColor} width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M18 1l-6 4-6-4-6 5v7l12 10 12-10v-7z\"></path></svg>\r\n                            </div>\r\n                            <div className=\"sc-iyvyFf bJqQCy\">{detailList.like}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"filetrList\">\r\n                    {\r\n                        detailLang.map((a, i)=>{\r\n                            return(\r\n                                <p key={i}>#{a}</p>\r\n                            )\r\n                        })\r\n                    }\r\n                    </div>\r\n                    {\r\n                        detailList.image === null\r\n                        ? null\r\n                        : <img src={detailList.image} alt=\"\"></img>\r\n                    }\r\n                   \r\n                </div>\r\n                <div className=\"detail__body-wrapper\">\r\n                    <div className=\"detail__content\">\r\n                        <p dangerouslySetInnerHTML={{\r\n                            __html: detailList.contents\r\n                        }}></p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"detail__footer-wrapper\">\r\n                    <div className=\"detail__writerInfo\">\r\n                        <div className=\"detail__topInfo\">\r\n                            <Link to={\"/mysite/\" + detailList.id}>\r\n                                <img src={detailList.profileImage} alt=\"\"></img>\r\n                            </Link>\r\n                            <div className=\"detail__userInfo\">\r\n                                <div className=\"description\">{detailUserInfo.myInfo}</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"sc-epnACN eIoWCE\"></div>\r\n                        <div className=\"detail__buttomInfo\">\r\n                      \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"detail__comment-wrapper\">\r\n                    {/* <h4>{commentList.length + reCommentList.length}개의 댓글</h4> */}\r\n                    <div className=\"detail__comment-width\">\r\n                        {/* <div>\r\n                            <textarea ref={commentTxt} defaultValue=\"\" placeholder=\"댓글을 작성하세요\" className=\"comment__textarea\" onChange={(e)=>{setCommentContent(e.target.value)}}></textarea>\r\n                            <div className=\"buttons-wrapper\">\r\n                                <button className=\"comment__btn\" onClick={()=>{CommentEffect(CommentSubmit)}}>댓글 작성</button>\r\n                            </div>\r\n                        </div> */}\r\n                        <div className=\"margin__top\">\r\n                            <div></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\nexport default Detail;"]},"metadata":{},"sourceType":"module"}