{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"C:/django-react/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router';import{Link}from'react-router-dom';import{SidebarDate}from'../Sidebar/SidebarData';import'./Header.css';import'../Sidebar/Sidebar.css';function Header(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),sidebar=_useState2[0],setSidebar=_useState2[1];var showSidebar=function showSidebar(){return setSidebar(!sidebar);};var history=useHistory();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),userprofile=_useState4[0],setUserprofile=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userPhoto=_useState6[0],setUserPhoto=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),currentUser_pk=_useState8[0],setCurrentUser_pk=_useState8[1];var onClickHandler=function onClickHandler(){//useDispatch를 사용해서 로그아웃 액션을 실행한다\n//useDispatch와 logout 액션이 두가지 필요하다\\\nlocalStorage.removeItem('token');history.push('/');window.location.reload();};// setTimeout(() => console.log(\"start\"), 10000);\n// if(props.modal === true){\n//     console.log(\"reload\");\n//     window.location.reload();\n// } else {}\nuseEffect(function(){fetch('http://39.118.174.168:8000/api/current_user/',{headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){return res.json();}).then(function(json){// 현재 유저 정보 받아왔다면, 로그인 상태로 state 업데이트 하고\nif(json.id){console.log(json.id);//유저정보를 받아왔으면 해당 user의 프로필을 받아온다.\n}fetch('http://39.118.174.168:8000/api/profile/'+json.id+'/update/',{method:'PATCH',headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){return res.json();}).then(function(userData){setUserPhoto(userData.photo);setCurrentUser_pk(userData.user_id);}).catch(function(error){console.log(error);});}).catch(function(error){console.log(error);});},[userPhoto]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"header-nav\",children:/*#__PURE__*/_jsx(\"div\",{className:\"header-nav-links\",children:props.modal===false||props.modal===null||props.modal===undefined?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(\"button\",{className:\"header-btns\",children:\"\\uB85C\\uADF8\\uC778\"})}),/*#__PURE__*/_jsx(Link,{to:\"/register\",children:/*#__PURE__*/_jsx(\"button\",{className:\"header-btns\",children:\"\\uD68C\\uC6D0\\uAC00\\uC785\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/write\",children:/*#__PURE__*/_jsx(\"button\",{className:\"header-dashboards\",children:\"New write\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"user-container\",onClick:function onClick(){setUserprofile(!userprofile);},children:/*#__PURE__*/_jsx(\"img\",{src:userPhoto,className:\"user-image\",onClick:showSidebar,alt:\"/\"})}),/*#__PURE__*/_jsx(\"nav\",{className:sidebar?'nav-menu active':'nav-menu',children:/*#__PURE__*/_jsxs(\"ul\",{className:\"nav-menu-items\",onClick:showSidebar,children:[/*#__PURE__*/_jsx(\"li\",{className:\"navbar-toggle\",children:/*#__PURE__*/_jsx(Link,{to:\"#\",className:\"menu-bars\"})}),SidebarDate.map(function(item,index){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"li\",{className:item.cName,children:/*#__PURE__*/_jsxs(Link,{to:item.path,children:[item.icon,/*#__PURE__*/_jsx(\"span\",{children:item.title})]})},index)});}),/*#__PURE__*/_jsx(\"button\",{className:\"logout\",onClick:onClickHandler,children:\"\\uB85C\\uADF8 \\uC544\\uC6C3\"})]})}),userprofile&&currentUser_pk===true?/*#__PURE__*/_jsx(_Fragment,{}):null]})})})})});}export default Header;","map":{"version":3,"sources":["C:/django-react/frontend/src/views/Header.js"],"names":["React","useState","useEffect","useHistory","Link","SidebarDate","Header","props","sidebar","setSidebar","showSidebar","history","userprofile","setUserprofile","userPhoto","setUserPhoto","currentUser_pk","setCurrentUser_pk","onClickHandler","localStorage","removeItem","push","window","location","reload","fetch","headers","Authorization","getItem","then","res","json","id","console","log","method","userData","photo","user_id","catch","error","modal","undefined","map","item","index","cName","path","icon","title"],"mappings":"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","sourcesContent":["import React, { useState, useEffect} from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport {Link} from 'react-router-dom';\r\nimport { SidebarDate } from '../Sidebar/SidebarData';\r\nimport './Header.css';\r\nimport '../Sidebar/Sidebar.css';\r\n\r\n\r\nfunction Header(props){\r\n    const [sidebar,setSidebar] = useState(false);\r\n    const showSidebar = () => setSidebar(!sidebar);\r\n    const history = useHistory();\r\n    let [userprofile, setUserprofile] = useState(false);\r\n    let [userPhoto, setUserPhoto] = useState();\r\n    let [currentUser_pk, setCurrentUser_pk] = useState();\r\n\r\n    const onClickHandler = () => {\r\n    //useDispatch를 사용해서 로그아웃 액션을 실행한다\r\n    //useDispatch와 logout 액션이 두가지 필요하다\\\r\n    localStorage.removeItem('token');\r\n    history.push('/');\r\n    window.location.reload();\r\n  }\r\n\r\n  // setTimeout(() => console.log(\"start\"), 10000);\r\n  // if(props.modal === true){\r\n  //     console.log(\"reload\");\r\n  //     window.location.reload();\r\n  // } else {}\r\n\r\n  useEffect(()=>{\r\n        fetch('http://39.118.174.168:8000/api/current_user/', {\r\n        headers: {\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n        }\r\n    })\r\n    .then(res => res.json())\r\n    .then(json => {\r\n      // 현재 유저 정보 받아왔다면, 로그인 상태로 state 업데이트 하고\r\n        if (json.id) {\r\n            console.log(json.id)\r\n        //유저정보를 받아왔으면 해당 user의 프로필을 받아온다.\r\n        }fetch('http://39.118.174.168:8000/api/profile/' + json.id + '/update/',{\r\n        method : 'PATCH',\r\n        headers: {\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n        },\r\n        })\r\n        .then((res)=>res.json())\r\n        .then((userData)=> {\r\n            setUserPhoto(userData.photo)\r\n            setCurrentUser_pk(userData.user_id)\r\n        })\r\n        .catch(error => {\r\n            console.log(error);\r\n          });\r\n    }).catch(error => {\r\n        console.log(error)\r\n    });\r\n    },[userPhoto])\r\n\r\n\r\n    \r\n\r\n    return(\r\n    <>\r\n        <div className=\"header\">\r\n        <div className=\"header-nav\">\r\n        <div className=\"header-nav-links\">  \r\n            {\r\n              props.modal === false || props.modal === null || props.modal === undefined\r\n              ? (\r\n              <>\r\n              <Link to=\"/login\"><button className=\"header-btns\">로그인</button></Link>\r\n              <Link to=\"/register\"><button className=\"header-btns\">회원가입</button></Link>\r\n              </>\r\n              )\r\n              : (\r\n                <>\r\n                 <Link  to=\"/write\"><button className=\"header-dashboards\">New write</button></Link>\r\n                    <div className=\"user-container\" onClick={()=>{setUserprofile(!userprofile)}}>\r\n                    <img src={userPhoto} className=\"user-image\" onClick={showSidebar} alt=\"/\"></img>\r\n                    </div>\r\n                      <nav className={sidebar ? 'nav-menu active' : 'nav-menu'}>\r\n                        <ul className='nav-menu-items' onClick={showSidebar}>\r\n                          <li className=\"navbar-toggle\">\r\n                            <Link to='#' className='menu-bars' />   \r\n                          </li>\r\n                    {SidebarDate.map((item, index) => {\r\n                       return (\r\n                        <>\r\n                          <li key={index} className={item.cName}>\r\n                            <Link to={item.path}>\r\n                              {item.icon}\r\n                              <span>\r\n                                {item.title}\r\n                              </span>\r\n                              \r\n                            </Link>\r\n                          </li>\r\n                          \r\n                        </>\r\n                       )\r\n                    })}\r\n                    \r\n                     \r\n                  <button className=\"logout\" onClick={onClickHandler}>로그 아웃</button>\r\n                 \r\n                      \r\n                   \r\n                        </ul>\r\n                        </nav>\r\n                {\r\n                  userprofile && currentUser_pk === true\r\n                  ?(\r\n                   <>\r\n                   </>\r\n                  )\r\n                  :null\r\n                }\r\n                </>\r\n              )\r\n            }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Header;"]},"metadata":{},"sourceType":"module"}